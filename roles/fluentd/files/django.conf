# Concat Django logs

# Example:
# [2017-01-24 21:59:06,133] [ERROR] Internal Server Error: /broken
# Traceback (most recent call last):
#   File "/opt/app-root/src/.local/lib/python3.5/site-packages/django/core/handlers/base.py", line 132, in get_response
#     response = wrapped_callback(request, *callback_args, **callback_kwargs)
#   File "/opt/app-root/src/welcome/views.py", line 27, in broken
#     raise Exception("Oops, you bwoke it.")
# Exception: Oops, you bwoke it.
# 10.1.0.1 - - [24/Jan/2017:21:59:06 +0000] "GET /broken HTTP/1.1" 500 27 "-" "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/55.0.2883.87 Safari/537.36"
<filter kubernetes>
  @type concat
  key log
  stream_identity_key container_id
  flush_interval 5
  timeout_label "@LASTLINE"

  # date format
  multiline_start_regexp /^\[\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2},\d{3}\]/
  # IP address
  multiline_end_regexp /^\d{1,3}\.\d{1,3}\.\d{1,3}/
</filter>
